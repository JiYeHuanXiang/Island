<!DOCTYPE html>
<html>
<head>
    <title>WebSocket测试</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>WebSocket连接测试</h1>
    <div id="status">未连接</div>
    <div id="output"></div>
    
    <script>
        const status = document.getElementById('status');
        const output = document.getElementById('output');
        
        function log(msg) {
            const div = document.createElement('div');
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${msg}`;
            output.appendChild(div);
        }
        
        log('开始WebSocket连接测试...');
        
        const ws = new WebSocket('ws://localhost:8088/ws');
        
        ws.onopen = function() {
            status.textContent = '已连接';
            status.style.color = 'green';
            log('WebSocket连接已建立');
            
            // 发送测试命令
            setTimeout(() => {
                log('发送命令: .help');
                ws.send('.help');
            }, 1000);
            
            setTimeout(() => {
                log('发送命令: .r 3d6');
                ws.send('.r 3d6');
            }, 2000);
        };
        
        ws.onmessage = function(event) {
            log(`收到响应: ${event.data}`);
        };
        
        ws.onerror = function(error) {
            status.textContent = '连接错误';
            status.style.color = 'red';
            log(`WebSocket错误: ${error}`);
        };
        
        ws.onclose = function() {
            status.textContent = '已断开';
            status.style.color = 'red';
            log('WebSocket连接已关闭');
        };
    </script>
</body>
</html>
